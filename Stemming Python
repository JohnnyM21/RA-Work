import pandas as pd
import re
import nltk
from nltk.stem import PorterStemmer

nltk.download("punkt", quiet=True)

url = "https://raw.githubusercontent.com/JohnnyM21/RA-Work/main/technology_misinformation_cleaned_sep.csv"
df = pd.read_csv(url)

stemmer = PorterStemmer()

def stem_text(text):
    if pd.isna(text):
        return text
    
    text = str(text).lower().strip()

    tokens = re.findall(r"[a-z0-9]+", text)
    
    stemmed_tokens = [stemmer.stem(t) for t in tokens]
    return " ".join(stemmed_tokens)

# ADD ONLY ONE COLUMN
df["tech_clean_sep_stem"] = df["tech_clean_sep"].apply(stem_text)

df.to_csv("technology_misinformation_with_stem.csv", index=False)
